#N canvas 340 46 853 622 12;
#X obj 344 108 r playhead;
#X obj 482 158 unpack f;
#X msg 482 341 tempo \$1 permin;
#X obj 465 593 outlet;
#X obj 254 133 inlet;
#X text 240 79 pre-beat threshold (x < 1.0), f 10;
#X obj 254 233 wrap;
#X msg 254 258 1 \$1;
#X obj 254 283 -;
#X obj 254 322 moses;
#X obj 154 108 loadbang;
#X msg 154 133 args 0;
#X obj 154 158 pdcontrol;
#X obj 154 183 pack 0.1;
#X obj 344 158 unpack f;
#X obj 344 220 change;
#X obj 344 270 wrap;
#X msg 295 433 1 \$1;
#X obj 295 458 -;
#X obj 295 514 f, f 15;
#X obj 295 484 delay;
#X obj 295 347 spigot 1;
#X obj 295 372 t f b, f 8;
#X msg 369 347 0;
#X obj 295 593 outlet;
#X text 270 613 tick messages;
#X text 438 613 tempo x permin;
#X obj 482 366 t a a;
#X msg 254 358 1;
#N canvas 0 30 450 300 roundUp 1;
#X obj 92 45 inlet;
#X obj 92 95 int;
#X obj 92 120 outlet;
#X obj 92 70 + 0.999999;
#X connect 0 0 3 0 empty;
#X connect 1 0 2 0 empty;
#X connect 3 0 1 0 empty;
#X restore 295 539 pd roundUp;
#N canvas 171 62 615 636 playInitTick 1;
#X obj 263 54 inlet;
#X obj 65 54 inlet;
#X obj 118 460 wrap;
#X msg 118 485 1 \$1;
#X obj 118 510 -;
#X obj 65 535 pack f f;
#X obj 65 560 outlet;
#X text 35 14 position messages (float only), f 17;
#X text 260 14 change-filtered playing flag, f 15;
#X text 132 54 "buddy" logic;
#X msg 173 125 1;
#X obj 151 161 |, f 8;
#X obj 151 186 t f f;
#X obj 65 287 f, f 5;
#X obj 65 79 t b f;
#X msg 124 125 2;
#X obj 151 236 t b b, f 10;
#X msg 253 186 0;
#X obj 65 375 spigot, f 32;
#X obj 65 312 t f f, f 26;
#X obj 65 400 t f f, f 8;
#X text 341 182 1 buddy (must get both play flag and beat counter before proceeding) \; 2 Pack play flag and time into "playAtBeat" message \; 3 Calculate time to next beat and generate partial-beat tick message., f 30;
#X obj 151 211 select 3;
#X obj 263 79 t b f;
#X connect 0 0 23 0 empty;
#X connect 1 0 14 0 empty;
#X connect 2 0 3 0 empty;
#X connect 3 0 4 0 empty;
#X connect 4 0 5 1 empty;
#X connect 5 0 6 0 empty;
#X connect 10 0 11 0 empty;
#X connect 11 0 12 0 empty;
#X connect 12 0 22 0 empty;
#X connect 12 1 11 1 empty;
#X connect 13 0 19 0 empty;
#X connect 14 0 15 0 empty;
#X connect 14 1 13 1 empty;
#X connect 15 0 11 0 empty;
#X connect 16 0 13 0 empty;
#X connect 16 1 17 0 empty;
#X connect 17 0 11 1 empty;
#X connect 18 0 20 0 empty;
#X connect 19 0 18 0 empty;
#X connect 20 0 5 0 empty;
#X connect 20 1 2 0 empty;
#X connect 22 0 16 0 empty;
#X connect 23 0 10 0 empty;
#X connect 23 1 18 1 empty;
#X restore 501 521 pd playInitTick;
#X f 16;
#X obj 344 183 t f f, f 10;
#X obj 344 133 route position bpm playing, f 60;
#X obj 622 158 t f a, f 11;
#X obj 622 183 change;
#X obj 344 245 t f f, f 8;
#X obj 482 183 change -1;
#X obj 482 208 t f f, f 9;
#X text 552 286 send tempo upon play start, f 15;
#X obj 510 296 f 120;
#X obj 622 208 t f b f;
#X obj 649 245 select 1;
#N canvas 738 241 450 300 handleIn 1;
#X obj 37 37 inlet;
#X obj 37 62 route debug;
#X obj 41 206 outlet;
#X obj 107 206 outlet;
#X connect 0 0 1 0 empty;
#X connect 1 0 3 0 empty;
#X connect 1 1 2 0 empty;
#X restore 254 158 pd handleIn;
#X obj 127 425 spigot;
#X obj 127 450 print pos1;
#X obj 397 484 spigot 1;
#X obj 653 585 outlet;
#X text 611 614 currently playing;
#X connect 0 0 32 0 empty;
#X connect 1 0 36 0 empty;
#X connect 2 0 27 0 empty;
#X connect 4 0 42 0 empty;
#X connect 6 0 7 0 empty;
#X connect 7 0 8 0 empty;
#X connect 8 0 9 1 empty;
#X connect 9 0 28 0 empty;
#X connect 9 1 21 0 empty;
#X connect 10 0 11 0 empty;
#X connect 11 0 12 0 empty;
#X connect 12 0 13 0 empty;
#X connect 13 0 6 0 empty;
#X connect 14 0 31 0 empty;
#X connect 15 0 35 0 empty;
#X connect 16 0 9 0 empty;
#X connect 17 0 18 0 empty;
#X connect 18 0 20 0 empty;
#X connect 19 0 29 0 empty;
#X connect 20 0 19 0 empty;
#X connect 21 0 22 0 empty;
#X connect 22 0 17 0 empty;
#X connect 22 1 23 0 empty;
#X connect 23 0 21 1 empty;
#X connect 23 0 45 1 empty;
#X connect 27 0 3 0 empty;
#X connect 27 1 20 0 empty;
#X connect 28 0 21 1 empty;
#X connect 28 0 45 1 empty;
#X connect 29 0 24 0 empty;
#X connect 30 0 24 0 empty;
#X connect 31 0 15 0 empty;
#X connect 31 1 30 0 empty;
#X connect 32 0 14 0 empty;
#X connect 32 1 1 0 empty;
#X connect 32 2 33 0 empty;
#X connect 33 0 34 0 empty;
#X connect 34 0 40 0 empty;
#X connect 35 0 16 0 empty;
#X connect 35 1 43 0 empty;
#X connect 35 1 45 0 empty;
#X connect 36 0 37 0 empty;
#X connect 37 0 2 0 empty;
#X connect 37 1 39 1 empty;
#X connect 39 0 2 0 empty;
#X connect 40 0 30 1 empty;
#X connect 40 2 41 0 empty;
#X connect 40 2 46 0 empty;
#X connect 41 0 39 0 empty;
#X connect 42 0 6 0 empty;
#X connect 42 1 43 1 empty;
#X connect 43 0 44 0 empty;
#X connect 45 0 19 1 empty;
